import{r as l,j as e,d as P,b as B,E as d,t as h,F as q,G as D,h as u,H,e as C}from"./index-ssgt0iHx.js";import{B as p}from"./Button-e45vHQYh.js";import{A as U,a as F}from"./ArticleContent-QVm4oUnN.js";import"./like-filled-dkih81t7.js";const L=o=>l.createElement("svg",{viewBox:"0 0 18 18",...o},l.createElement("polygon",{className:"ql-fill ql-stroke",points:"6 10 4 12 2 10 6 10"}),l.createElement("path",{className:"ql-stroke",d:"M8.09,13.91A4.6,4.6,0,0,0,9,14,5,5,0,1,0,4,9"})),_=o=>l.createElement("svg",{viewBox:"0 0 18 18",...o},l.createElement("polygon",{className:"ql-fill ql-stroke",points:"12 10 14 12 16 10 12 10"}),l.createElement("path",{className:"ql-stroke",d:"M9.91,13.91A4.6,4.6,0,0,1,9,14a5,5,0,1,1,5-5"})),R=o=>l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:24,viewBox:"0 -960 960 960",width:24,...o},l.createElement("path",{d:"M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm40-80h480L570-480 450-320l-90-120-120 160Zm-40 80v-560 560Z"})),O=({className:o})=>e.jsxs("div",{id:"toolbar",className:`${o}`,children:[e.jsx("div",{className:"ql-formats",children:e.jsxs("select",{className:"ql-header",value:"",onChange:n=>n.persist(),children:[e.jsx("option",{value:"1",children:"Header 1"}),e.jsx("option",{value:"2",children:"Header 2"}),e.jsx("option",{value:"3",children:"Header 3"}),e.jsx("option",{value:"4",children:"Header 4"}),e.jsx("option",{value:"5",children:"Header 5"}),e.jsx("option",{value:"6",children:"Header 6"}),e.jsx("option",{value:"",children:"Header"})]})}),e.jsx("div",{className:"ql-formats",children:e.jsxs("select",{className:"ql-size",value:"",onChange:n=>n.persist(),children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"12",children:"12"}),e.jsx("option",{value:"14",children:"14"}),e.jsx("option",{value:"16",children:"16"}),e.jsx("option",{value:"18",children:"18"}),e.jsx("option",{value:"20",children:"20"}),e.jsx("option",{value:"22",children:"22"}),e.jsx("option",{value:"24",children:"24"}),e.jsx("option",{value:"26",children:"26"}),e.jsx("option",{value:"28",children:"28"}),e.jsx("option",{value:"30",children:"30"}),e.jsx("option",{value:"",children:"Size"})]})}),e.jsx("div",{className:"ql-formats",children:e.jsxs("select",{className:"ql-font",value:"",onChange:n=>n.persist(),children:[e.jsx("option",{value:"arial",children:"Arial"}),e.jsx("option",{value:"comic-sans",children:"Comic Sans"}),e.jsx("option",{value:"courier-new",children:"Courier New"}),e.jsx("option",{value:"georgia",children:"Georgia"}),e.jsx("option",{value:"helvetica",children:"Helvetica"}),e.jsx("option",{value:"lucida",children:"Lucida"}),e.jsx("option",{value:"",children:"Font"})]})}),e.jsxs("div",{className:"ql-formats",children:[e.jsx("button",{className:"ql-align",value:""}),e.jsx("button",{className:"ql-align",value:"center"}),e.jsx("button",{className:"ql-align",value:"right"}),e.jsx("button",{className:"ql-align",value:"justify"})]}),e.jsxs("span",{className:"ql-formats",children:[e.jsx("button",{className:"ql-bold"}),e.jsx("button",{className:"ql-italic"}),e.jsx("button",{className:"ql-underline"}),e.jsx("button",{className:"ql-strike"})]}),e.jsxs("span",{className:"ql-formats",children:[e.jsx("button",{className:"ql-list",value:"ordered"}),e.jsx("button",{className:"ql-list",value:"bullet"}),e.jsx("button",{className:"ql-indent",value:"-1"}),e.jsx("button",{className:"ql-indent",value:"+1"})]}),e.jsxs("span",{className:"ql-formats",children:[e.jsx("button",{className:"ql-code-block"}),e.jsx("button",{className:"ql-formula"}),e.jsx("button",{className:"ql-clean"})]}),e.jsxs("span",{className:"ql-formats",children:[e.jsx("button",{className:"ql-blockquote"}),e.jsx("button",{className:"ql-script",value:"sub"}),e.jsx("button",{className:"ql-script",value:"super"})]}),e.jsxs("span",{className:"ql-formats",children:[e.jsx("select",{className:"ql-color",value:"",onChange:n=>n.persist()}),e.jsx("select",{className:"ql-background",value:"",onChange:n=>n.persist()})]}),e.jsxs("span",{className:"ql-formats",children:[e.jsx("button",{className:"ql-link"}),e.jsx("button",{className:"ql-custom-image",children:e.jsx(R,{})}),e.jsx("button",{className:"ql-video"})]}),e.jsxs("span",{className:"ql-formats",children:[e.jsx("button",{className:"ql-undo",children:e.jsx(L,{})}),e.jsx("button",{className:"ql-redo",children:e.jsx(_,{})})]})]}),K=()=>{const o=P(),n=B(t=>t.category.leafCategories),[b,y]=l.useState(),[I,N]=l.useState(""),[s,i]=l.useState(),[m,S]=l.useState(!1),[x,j]=l.useState(!1),[f,g]=l.useState(!1),[c,w]=l.useState(!1);l.useEffect(()=>(v(),o(d("https://jeheecheon.s3.ap-northeast-2.amazonaws.com/blog/defaults/images/cover.jpg")),()=>{o(d(""))}),[]);const v=()=>fetch("https://jeheecheon.azurewebsites.net/api/blog/posts/list",{headers:{Authorization:`Bearer ${sessionStorage.getItem("jwt")}`}}).then(t=>{if(t.ok)return t.json();h(t)}).then(t=>{t&&t.length>0&&(q(t),D(t),y(t))}).catch(t=>{u(t),alert("Error occured while fecthing a list of posts..")}),$=t=>{N(t),i({}),t!==""?fetch(`https://jeheecheon.azurewebsites.net/api/blog/post/${t}/with-metadata`,{headers:{Authorization:`Bearer ${sessionStorage.getItem("jwt")}`}}).then(a=>{if(a.ok)return a.json();h(a)}).then(a=>{a?(q(a),i(a),a.Cover!==void 0&&a.Cover!==null?o(d(a.Cover)):o(d("https://jeheecheon.s3.ap-northeast-2.amazonaws.com/blog/defaults/images/cover.jpg"))):C("Post is null or undefined")}).catch(a=>{u(a),alert("Failed to fetch the post info...")}):o(d("https://jeheecheon.s3.ap-northeast-2.amazonaws.com/blog/defaults/images/cover.jpg"))},T=()=>{confirm("You want to update the post, right?")&&fetch(`https://jeheecheon.azurewebsites.net/api/blog/post/update?set_edited_date_as_null=${f}&set_edited_date=${x}&set_uploaded_date=${c}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${sessionStorage.getItem("jwt")}`},body:JSON.stringify(s)}).then(t=>{t.ok?(v(),j(!1),g(!1),w(!1)):h(t)}).catch(t=>{alert("Failed to update the current post"),u(t)})},E=()=>{confirm("Are you sure you wnat to delete this post?????!")&&fetch(`https://jeheecheon.azurewebsites.net/api/blog/post/${s==null?void 0:s.Id}`,{headers:{Authorization:`Bearer ${sessionStorage.getItem("jwt")}`},method:"DELETE"}).then(t=>{t.ok?(N(""),v(),i({})):h(t)}).catch(t=>{alert("Failed to delete the selected post"),u(t)})},z=()=>{fetch("https://jeheecheon.azurewebsites.net/api/blog/post/upload-empty",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${sessionStorage.getItem("jwt")}`}}).then(t=>{t.ok?v():h(t)}).catch(t=>{alert("Failed to create an empty post"),u(t)})},A=t=>{if(t.currentTarget.files!==null&&t.currentTarget.files!==void 0){const a=t.currentTarget.files[0];if(a!=null){const k=new FormData;k.append("image",a),fetch(`https://jeheecheon.azurewebsites.net/api/blog/posts/${s==null?void 0:s.Id}/images/upload`,{headers:{Authorization:`Bearer ${sessionStorage.getItem("jwt")}`},method:"POST",body:k}).then(r=>{if(r.ok)return r.json();h(r)}).then(r=>{r&&s?(console.log(r),o(d(r)),i({...s,Cover:r})):C("Image URL is null or undefined")}).catch(r=>{alert("Failed to upload the selected image to s3"),u(r)})}}};return e.jsxs(e.Fragment,{children:[e.jsxs(H,{children:[e.jsx("title",{children:"Edit | jeheecheon"}),e.jsx("link",{rel:"canonical",href:"https://blog.jeheecheon.com"}),e.jsx("meta",{name:"description",content:"Blog post edit page"}),e.jsx("meta",{name:"keywords",content:"tech, blog, jeheecheon"}),e.jsx("meta",{name:"author",content:"jeheecheon"}),"/",e.jsx("meta",{property:"og:title",content:"Edit | jeheecheon"}),e.jsx("meta",{property:"og:description",content:"Blog post edit page"}),e.jsx("meta",{property:"og:image",content:"https://jeheecheon.s3.ap-northeast-2.amazonaws.com/blog/defaults/images/cover.jpg"}),e.jsx("meta",{property:"og:type",content:"website"}),e.jsx("meta",{property:"og:site_name",content:"jeheecheon"}),e.jsx("meta",{property:"og:locale",content:"ko_KR"}),e.jsx("meta",{property:"og:url",content:"https://blog.jeheecheon.com"}),e.jsx("meta",{name:"twitter:title",content:"Edit | jeheecheon"}),e.jsx("meta",{name:"twitter:card",content:"summary"}),e.jsx("meta",{name:"twitter:description",content:"Blog post edit page"}),e.jsx("meta",{name:"twitter:image",content:"https://jeheecheon.s3.ap-northeast-2.amazonaws.com/blog/defaults/images/cover.jpg"})]}),m&&s&&e.jsx(U,{children:e.jsx(F,{post:{...s,LikeCnt:1004}})}),e.jsxs("div",{className:`flex flex-col items-center mt-[30vh] text-default-15-dark dark:text-default-15 max-w-[768px] mx-auto
                ${m&&"hidden"}`,children:[e.jsx("p",{className:"text-2xl font-medium mt-2",children:"글 작성"}),e.jsxs("select",{id:"post-id-select",value:I,onChange:t=>$(t.currentTarget.value),className:`mt-2 text-default-18-dark dark:text-default-18 outline-none focus:outline-none w-full\r
                            bg-default-3 dark:bg-default-3-dark border-[1px] border-default-10 dark:border-default-6-dark`,children:[e.jsx("option",{value:"",children:"Select a post"}),b&&b.map(t=>e.jsx("option",{value:t.Id,children:`ID: ${t.Id} | Title: ${t.Title} | Date: ${t.UploadedAt.toLocaleString()}`},t.Id))]}),e.jsxs("div",{className:"flex my-2 gap-2 justify-end w-full",children:[(s==null?void 0:s.Id)&&e.jsxs("div",{children:[e.jsx("input",{id:"IdOfPostEditing",type:"text",value:s==null?void 0:s.Id,onChange:()=>{},className:"invisible absolute"}),e.jsx(p,{children:e.jsxs("label",{className:"flex items-center gap-3 text-default-16-dark dark:text-default-16 text-nowrap",children:["Change Cover",e.jsx("input",{type:"file",className:"border-2 hidden",onInput:A})]})})]}),e.jsx(p,{onClick:z,className:"text-default-16-dark dark:text-default-16 text-nowrap",children:"Create Post"})]}),(s==null?void 0:s.Id)&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"sticky top-0 z-[50] mt-2",children:[e.jsxs("div",{className:"flex",children:[e.jsx("input",{value:s.Title,onChange:t=>i({...s,Title:t.currentTarget.value}),className:`w-full pl-2 text-default-10-dark py-2 focus:outline-none outline-none\r
                                        bg-white border-[1px] border-default-10 rounded-none`}),e.jsx("select",{className:`text-default-10-dark focus:outline-none outline-none\r
                                        bg-white border-[1px] border-default-10 rounded-none`,value:s.CategoryId?s.CategoryId:"",onChange:t=>i({...s,CategoryId:t.currentTarget.value}),children:n.map(t=>e.jsx("option",{value:t.Id,children:t.Id},t.Id))})]}),e.jsx(O,{className:"w-full bg-white opacity-100"})]})})]}),(s==null?void 0:s.Id)&&e.jsxs("div",{className:`flex flex-col w-full gap-3 pb-10 mx-auto px-1 mt-2
                    text-default-18-dark dark:text-default-18
                    max-w-[768px]`,children:[e.jsxs("label",{children:["Public: ",e.jsx("input",{type:"checkbox",checked:s.IsPublic,onChange:()=>i({...s,IsPublic:!s.IsPublic})})]}),e.jsxs("label",{children:["Reset uploaded date: ",e.jsx("input",{type:"checkbox",checked:c,onChange:()=>{c||g(!0),w(!c),j(!1)}})]}),e.jsxs("label",{children:["Update edited date: ",e.jsx("input",{type:"checkbox",checked:x,onChange:()=>{c||(x||g(!1),j(!x))}})]}),e.jsxs("label",{children:["Set edited date as null: ",e.jsx("input",{type:"checkbox",checked:f,onChange:()=>{c||(f||j(!1),g(!f))}})]}),e.jsxs("div",{className:"flex justify-center gap-3 flex-wrap mt-2",children:[e.jsx(p,{onClick:T,className:"text-sky-500 dark:text-sky-600 font-medium",children:"Update"}),e.jsx(p,{onClick:E,className:"text-red-500 dark:text-red-500 font-medium",children:"Delete"}),e.jsx(p,{onClick:()=>{S(!m)},className:"font-medium",children:m?"Edit":"Preview"})]})]})]})};export{K as default};
