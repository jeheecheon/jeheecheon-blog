import{r as d,j as e,R as g,b as p,W as S,D as y,h as I,C as j,t as C,q as k,o as B,g as L,X as T,Y as O,H as R}from"./index-1FnqgYnk.js";import{p as Q,D as V,S as $,A as F,a as G}from"./ArticleContent-ge6zmTDs.js";import{S as D,E as Z,a as W,C as U,w as b}from"./ErrorMessageWrapper-XAuB3_2n.js";import{B as w}from"./Button-VdYjoZ9I.js";import{A as N}from"./Avatar-b6aGqiN9.js";import{S as H}from"./like-filled-V4CII7Sh.js";const P="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAIAAABt+uBvAAAAA3NCSVQICAjb4U/gAAAFG0lEQVR4nO2aT08bRxTA35vddby0tTFVXKVSOQQR0m/QT5Iri9Q2FKlFpKiqkMgFiUrBAVEk/rUS5pqvE0VgI3KgSgNExfZWeB3v7rwejFK1GB6sx2OQ5nfwxdo3b387OztvZnB86yswXIzodQI3HSOIwQhiMIIYjCAGI4jBCGIwghiMIAYjiMEIYjCCGIwgBiOIwQhiMIIYjCAGI4jBCGIwghiMIAYjiMHudQKw5G1UIKydNAI/kjEBgLDQzdjZgXQOnKni496mh73aFyOiubHVg30fCYWFKBAQEFt/ARCQJBkTIQ0OZWa3JrD1n3Z6I6jgrZf2K4hC2MyNE4GMiEiODOWmi+O6EvyXHoxBM6PLu+Wq5ViWw3cLRLActBxrt1ydGV3WkuB/0C1o+tHiu9eB44prvTGI4Lji3etg+tFi11Jrj1ZBM6PLtbdNO5WwUTslam+bmvuRPkEFb/14L0hsp4WdEsd7QcFbV5UViyZBRFTar9hpBc3ZaVHarxBR56GugiZBc2OriNcbdy4CERDF3NiqglhXQJOgg31f2MomMsLGg31fVTSmLQ1tLHkbSConeoiAhEvehrKIF6NDUAVCYSmeBwsLKxCqjdm+IQ1t1E4aKBQLQoG1k4bamG3RISjwI1BeSCEEfqQ6aBt0CJIRKa80EaFV+ncbLV+xLtXhWmZCOgQJC5VP64hA4bzhEnQIcjO2+qdN4GZ0rPbpEJQdSJNUbIgkZQfSamO2RYegHDjKB1QZUw4ctTHbokPQVPExocrqkggISc9ytaZabHAoIyNlhmREg0MZVdEuR5Og2a0JIqmkExEBkZzdmlAQ6wpoEoSII0O5qCE7DxU15MhQTtsmh74VxenieH7YjZodOYqaMj/s6tze0LomPb89mb2XSuwoasrsvdT89qTarC5H965G4cWTu/fdMLjeeEQEYSDv3ncLL550LbX29GBfbH578uGD/jiM45D/9hNBHFIcxg8f9GvuOy3M1jNDzwR9wBxeuN2Y80EMRhCDEcRgBDEYQQxGEIMRxNCbU67PvMU0ZE8hrEMY1KPG32HYIBmdLVwjgLCFk8b0J47bZ/eB8xE4Daj9VNRdiIG2iSIR/Tr2mw9RxQ/84yYAIgIiIsLZrnTr50OpAWfbXiSJCIhaVRtl8qlcxs2A/cPWN3qKj+4K+sVbAPj4uFb3j5tCIAoUArGD15okSEkkSUrK5FP5bB/C6c/FaXUp/5+uCIojWfh6849jv1GVwm7VosobAZIgY5IRpfvFF/nM9O/fWrb6ZhQLeu6t/AXyaK9uWaJLXs7TMhXH8rPhvk9B/Fj8XmFwZYKWvJU/G9HJQcN2hJ5N4fPIiKJQDgymP0/bU4o0qXnET72VV+VT/zBMuVav7ACAsDHlWv5h+Kp8+tRbURKz0x607K3tHPgyAsvpmZe2xCEJG74czEwWv+skTkc9aMFbe1muAeFNswMAloNA+LJcW/DWOomTXNAzb223VHVcoWckTgAKcFyxW6o+68BRwptb8TZL5Wqqz0rcsDZSfVapXF3xNpNdnlDQzpuqc+cW2Gnh3LF23lSTXZtEUMHbCAN5Y9+s86CAMJCFROeqk9zlYb1uObdHDwAAWI44rNcTXJjkPv2j9906l9k9EPyj9wmuSyJIxuqP9XabxMeGE70pt83OGYnSvmVDiX6MIAYjiMEIYjCCGIwgBiOIwQhiMIIYjCAGI4jBCGIwghiMIAYjiMEIYjCCGIwghn8AO43uyjW7PsoAAAAASUVORK5CYII=",K=({className:a,content:s,handleType:r,onSelect:i,onClick:l,disabled:o,placeholder:n="Write a comment..."})=>{const c=d.useRef(null),t=d.useRef(null);return d.useEffect(()=>{c.current.value=t.current.value,c.current.style.height="auto",t.current.style.height=c.current.scrollHeight+"px"},[s]),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("textarea",{ref:t,value:s,onChange:r,maxLength:700,rows:1,onClick:l,className:`${a} w-full relative bottom-4 overflow-y-hidden`,onSelect:i,disabled:o,placeholder:n}),e.jsx("textarea",{ref:c,className:"invisible w-full overflow-y-hidden",rows:1})]})};function z(){return e.jsxs("svg",{width:"2.8125rem",height:"2.8125rem",viewBox:"0 0 128 128","data-name":"Layer 1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("defs",{children:e.jsx("style",{dangerouslySetInnerHTML:{__html:".cls-1{fill:#a7aece;}.cls-2{fill:#ffffff;opacity:0.3;}.cls-3{fill:#7f3838;}.cls-4{fill:#bc5b57;}.cls-5{fill:#ffd8c9;}.cls-10,.cls-6,.cls-9{fill:none;stroke-linecap:round;}.cls-10,.cls-6{stroke:#393c54;stroke-linejoin:round;}.cls-6{stroke-width:0.1875rem;}.cls-7{fill:#393c54;}.cls-8{fill:#515570;}.cls-9{stroke:#ffffff;stroke-miterlimit:10;stroke-width:0.125rem;opacity:0.1;}.cls-10{stroke-width:0.375rem;}"}})}),e.jsx("title",{}),e.jsx("circle",{className:"cls-1",cx:"64",cy:"64",r:"60"}),e.jsx("circle",{className:"cls-2",cx:"64",cy:"64",r:"48"}),e.jsx("path",{className:"cls-3",d:"M40,22A10,10,0,0,0,30,32v81.43a59.62,59.62,0,0,0,20,8.91V32A10,10,0,0,0,40,22Z"}),e.jsx("path",{className:"cls-4",d:"M107.85,85.85c0-14.49-9.1-25-21.9-28.94l2-3.31a.59.59,0,0,0-.58-.9l-6,.82a.59.59,0,0,1-.54-1l2.66-3.2a.59.59,0,0,0-.54-1,100,100,0,0,0-21.07,5.4A35,35,0,0,0,40.15,85.85v3.22c0,15.48-1.65,21.18-6.36,26.76h0a59.94,59.94,0,0,0,72-8.77l0-.16A94.24,94.24,0,0,0,107.85,85.85Z"}),e.jsx("path",{className:"cls-5",d:"M88.74,93.46a6.31,6.31,0,0,1-5-7.63,6.55,6.55,0,0,1,7.58-4.72l5.91,1A.8.8,0,0,0,98,81c-3.89-7-13.76-12.64-24-12.64S53.88,74,50,81a.8.8,0,0,0,.83,1.18l5.91-1a6.55,6.55,0,0,1,7.58,4.72,6.31,6.31,0,0,1-5.05,7.63L51.09,94.9a.8.8,0,0,0-.53,1.23c3.23,5,10.2,8.42,23.44,8.42s20.21-3.38,23.44-8.42a.8.8,0,0,0-.53-1.23Z"}),e.jsx("path",{className:"cls-6",d:"M81.89,92.19a9,9,0,0,1-2.77,2.21,11.61,11.61,0,0,1-10.24,0"}),e.jsx("path",{className:"cls-7",d:"M79.12,86.62c0,2.83-2.29,4.25-5.12,4.25s-5.12-1.42-5.12-4.25C68.88,85,79.12,84.75,79.12,86.62Z"}),e.jsx("path",{className:"cls-7",d:"M57.33,87.48l3.05-.73a.71.71,0,0,1,.89.68,4,4,0,0,1-4.28,4,3.9,3.9,0,0,1-3-1.84,3.94,3.94,0,0,1,5.53-5.37.73.73,0,0,1,.08,1.11Z"}),e.jsx("path",{className:"cls-7",d:"M90.4,87.48l3-.73a.72.72,0,0,1,.89.68,4,4,0,0,1-4.29,4,3.88,3.88,0,0,1-3-1.84,3.94,3.94,0,0,1,5.52-5.37.72.72,0,0,1,.09,1.11Z"}),e.jsx("path",{className:"cls-7",d:"M92,29H15.28A59.76,59.76,0,0,0,7.09,45H92a8,8,0,0,0,0-16Z"}),e.jsx("circle",{className:"cls-8",cx:"92",cy:"37",r:"8"}),e.jsx("circle",{className:"cls-9",cx:"92",cy:"37",r:"4.31"}),e.jsx("line",{className:"cls-10",x1:"13",x2:"20.5",y1:"42",y2:"49.5"}),e.jsx("line",{className:"cls-10",x1:"66",x2:"74.38",y1:"32.1",y2:"23.72"})]})}const v=g.memo(({postId:a,replyingTo:s,handleCancelClicked:r,refreshComments:i,className:l})=>{const o=p(S),n=p(y),c=I(),[t,x]=d.useState(""),h=m=>{n===!1?c(j(!0)):x(m.currentTarget.value)},u=()=>{if(n===!1){c(j(!0));return}fetch(`https://jeheecheon.azurewebsites.net/api/blog/post/${a}/comment`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${sessionStorage.getItem("jwt")}`},body:JSON.stringify({content:t,parent_comment_id:s})}).then(m=>{m.ok?(i(),x("")):C(m)}).catch(m=>{k(m),alert("Failed to upload the comment..")}).finally(()=>r&&r())};return e.jsxs("div",{className:`rounded-lg flex flex-col w-full
                px-4 py-3 bg-default-4 dark:bg-body  ${l}`,children:[e.jsxs("div",{className:"flex w-full gap-3",children:[e.jsx(N,{avatar:n&&o.avatar?o.avatar:void 0,size:45,children:e.jsx(z,{})}),e.jsx(K,{content:t,handleType:h,className:`focus:outline-none resize-none mt-8\r
                        border-b-[0.0625rem] border-slate-500 rounded-none\r
                        bg-transparent`})]}),e.jsxs("div",{className:"flex items-center justify-end w-full gap-3 text-sm flex-wrap",children:[e.jsx(w,{onClick:u,className:"text-orange-400 dark:text-orange-400 font-bold dark:font-normal text-sm",children:"Upload"}),s&&e.jsx(w,{onClick:()=>{x(""),r!==void 0&&r()},children:"Cancel"})]})]})}),Y=a=>(a.forEach(s=>s.UploadedAt=new Date(Date.parse(s.UploadedAt.toString()))),a),J=a=>{a.sort((l,o)=>l.UploadedAt.getTime()-o.UploadedAt.getTime());const s=new Map;for(const l of a){const o=l.ParentCommentId||"";s.has(o)||s.set(o,[]),s.get(o).push(l)}const r=[],i=(l,o)=>{const n=s.get(l)||[];for(const c of n)c.depth=o,r.push(c),i(c.Id,o+1)};return i("",0),r},X=a=>{const r=new Date().getTime()-a.getTime(),i=60*1e3,l=i*60,o=l*24,n=o*30,c=o*365;if(r<i){let t=Math.floor(r/1e3);return t=t<0?0:t,`${t} ${t===1?"second":"seconds"} ago`}else if(r<l){let t=Math.floor(r/i);return t=t<0?0:t,`${t} ${t===1?"minute":"minutes"} ago`}else if(r<o){let t=Math.floor(r/l);return t=t<0?0:t,`${t} ${t===1?"hour":"hours"} ago`}else if(r<n){let t=Math.floor(r/o);return t=t<0?0:t,`${t} ${t===1?"day":"days"} ago`}else if(r<c){let t=Math.floor(r/n);return t=t<0?0:t,`${t} ${t===1?"month":"months"} ago`}else{let t=Math.floor(r/c);return t=t<0?0:t,`${t} ${t===1?"year":"years"} ago`}};function A({children:a,onClick:s,className:r}){return e.jsx("button",{type:"button",className:`flex flex-row rounded justify-between items-center w-fit cursor-pointer
            border-2 py-[0.1875rem] px-2 text-xs gap-2 text-default-17-dark dark:text-default-15
            bg-default-1 dark:bg-default-3-dark border-default-6 dark:border-default-8-dark ${r}`,onClick:s,children:a})}const q=g.memo(({postId:a,comment:s,refreshComments:r})=>{const i=I(),l=p(y),o=d.useRef(Q(V.sanitize(s.Content))),[n,c]=d.useState(s.HasLiked),[t,x]=d.useState(!1),h=d.useRef(!1),[u,m]=d.useState(s.LikeCnt),E=()=>{if(h.current!==!0){if(l===!1){i(j(!1));return}h.current=!0,fetch(`https://jeheecheon.azurewebsites.net/api/blog/comment/${s.Id}/has-liked`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${sessionStorage.getItem("jwt")}`},body:JSON.stringify(!n)}).then(f=>{if(f.ok)return f.json();C(f)}).then(f=>{n==null&&B("has_liked is null or undefined"),c(f),m(u+(f?1:-1))}).catch(k).finally(()=>{h.current=!1})}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-row auto-cols-min rounded-lg",children:[s.ParentCommentId&&e.jsx("div",{className:"flex flex-row",children:Array.from({length:s.depth}).map((f,M)=>e.jsx("div",{className:"w-0 border-r-[0.1125rem] mr-[0.8rem] md:mr-4 lg:mr-6 border-default-8 dark:border-default-10-dark"},M))}),e.jsxs("div",{className:"py-4 w-full space-y-3",children:[e.jsxs("div",{className:"w-full flex flex-row flex-nowrap",children:[e.jsx(N,{avatar:s.Avatar?s.Avatar:P,size:38}),e.jsxs("div",{className:"flex flex-col ml-2 justify-center text-sm md:text-base",children:[e.jsxs("div",{className:"flex flex-row flex-wrap items-center",children:[e.jsx("span",{className:`w-fit border rounded-2xl mr-1 px-[0.4375rem] text-[0.7rem] break-all
                                        text-center
                                    ${s.Email!=="jeheecheon@gmail.com"&&"hidden"} border-orange-400 text-orange-400`,children:"Site Owner"}),e.jsx("span",{className:"text-default-18-dark text-xs break-all",children:X(s.UploadedAt)})]}),e.jsx("p",{className:"dark:text-default-14 text-[0.8rem] break-all",children:s.Email})]})]}),e.jsx("div",{className:`min-h-[3.125rem] py-2 px-3 rounded-lg text-sm md:text-base break-all\r
                            bg-default-4 dark:bg-body dark:text-default-14 w-full`,children:o.current}),e.jsxs("div",{className:"flex flex-row flex-wrap gap-3",children:[e.jsxs(A,{onClick:E,children:[n?e.jsx(H,{className:"fill-red-500"}):e.jsx($,{className:"fill-gray-500 dark:fill-gray-500"}),e.jsx("span",{children:u})]}),e.jsxs(A,{onClick:()=>{if(l===!1){i(j(!1));return}x(!t)},children:[e.jsx(D,{className:`transition-colors duration-500 ${t?"fill-orange-500":"fill-gray-500 dark:fill-gray-500"}`}),e.jsx("span",{children:"Reply"})]})]})]})]}),e.jsx(v,{postId:a,replyingTo:s.Id,handleCancelClicked:()=>x(!1),refreshComments:r,className:`my-2 ${t?"opacity-100 block":"opacity-0 absolute left-0 w-fit invisible"} transition-opacity duration-1000`})]})}),_=g.memo(({className:a,postId:s,commentsAwaiter:r,refreshComments:i})=>{const l=d.useMemo(()=>{const o=r.Await();return J(Y(o.map(n=>n)))},[r]);return e.jsxs("div",{className:`w-full flex flex-col mb-4
                ${a}`,children:[e.jsx("div",{className:"mb-2 border-b-2 pb-1 border-b-default-13 dark:border-b-default-18-dark",children:e.jsxs("p",{className:"pl-2 text-base md:text-xl text-orange-400 font-ligh",children:[l.length," Comments"]})}),e.jsx(v,{postId:s,refreshComments:i,className:"mt-2 mb-[3.75rem]"}),l.map(o=>e.jsx(q,{comment:o,postId:s,refreshComments:i},o.Id))]})}),ee=g.memo(({post:a,commentsAwaiter:s,refreshComments:r})=>e.jsxs(F,{children:[e.jsx(G,{post:a}),e.jsx("div",{className:"max-w-[56.25rem] w-full px-3 md:px-5",children:e.jsx(Z,{fallback:e.jsx(W,{children:"Failed to load comments for this post..."}),children:e.jsx(d.Suspense,{fallback:e.jsx(L,{textSize:"text-sm",children:"Loading Comments... ðŸ¶"}),children:e.jsx(_,{className:"",postId:a.Id,commentsAwaiter:s,refreshComments:r})})})})]})),ne=()=>{const a=T(),s=d.useMemo(()=>`https://jeheecheon.azurewebsites.net/api/blog/post/${a.Id}/comments`,[a.Id]),[r,i]=d.useState(U());d.useEffect(()=>{i(b(fetch(s,{headers:{Authorization:`Bearer ${sessionStorage.getItem("jwt")}`}})))},[s]);const l=p(n=>n.category.leafCategories),o=d.useMemo(()=>O(l.find(n=>n.Id===a.CategoryId)),[l,a.CategoryId]);return e.jsxs(e.Fragment,{children:[e.jsx(ee,{post:a,commentsAwaiter:r,refreshComments:()=>i(b(fetch(s,{headers:{Authorization:`Bearer ${sessionStorage.getItem("jwt")}`}})))}),e.jsxs(R,{children:[e.jsxs("title",{children:[a.Title," | ","jeheecheon"]}),e.jsx("link",{rel:"canonical",href:`https://blog.jeheecheon.com/post/${a.Id}`}),e.jsx("meta",{name:"description",content:a.Title}),e.jsx("meta",{name:"keywords",content:`jeheecheon, tech, blog, ${o}`}),e.jsx("meta",{name:"author",content:"jeheecheon"}),"/",e.jsx("meta",{property:"og:title",content:`${a.Title} | ${name}`}),e.jsx("meta",{property:"og:description",content:a.Title}),e.jsx("meta",{property:"og:image",content:a.Cover?a.Cover:"https://jeheecheon.s3.ap-northeast-2.amazonaws.com/blog/defaults/images/cover.jpg"}),e.jsx("meta",{property:"og:type",content:"website"}),e.jsx("meta",{property:"og:site_name",content:"jeheecheon"}),e.jsx("meta",{property:"og:locale",content:"ko_KR"}),e.jsx("meta",{property:"og:url",content:`https://blog.jeheecheon.com/post/${a.Id}`}),e.jsx("meta",{name:"twitter:title",content:`${a.Title} | ${name}`}),e.jsx("meta",{name:"twitter:card",content:"summary"}),e.jsx("meta",{name:"twitter:description",content:a.Title}),e.jsx("meta",{name:"twitter:image",content:"https://jeheecheon.s3.ap-northeast-2.amazonaws.com/blog/defaults/images/cover.jpg"})]})]})};export{ne as default};
